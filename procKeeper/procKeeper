#!/bin/bash
sync(){
	echo "sync"
}
create() {
	echo "Введите имя отслеживаемого процесса"
	read name
	echo "Выберите период проверки (в минутах)"
	read time
	touch tab.tmp
	if [[ $(sed -n '$=' tab.tmp) -le 1 ]]
		then
		echo "DISPLAY=:0" > tab.tmp
	fi
    echo "*/$time * * * * bash /home/oleg/scripts/bash/procKeeper/procKeeper $name" >> tab.tmp
    crontab tab.tmp
    show
}
track(){
	if [[ $(pidof $per) > 1 ]]
		then
		echo "Процесс есть"
	else
		echo "Процесса нет"
		$per
	fi
}
show(){
	crontab -l | sed -n /procKeeper/p
	#cat tab.tmp | sed -n `2,$p`
}
edit(){
	show
	remove
	create
}
remove(){
	show
	echo "Выберите отслеживание для удаления:"
	read num
	#crontab -l | sed -n '/procKeeper/p' | sed -n "/${num}/p"
	let "num+=1"
	sed -i "${num} d" tab.tmp
	crontab tab.tmp
	show
}
per=$1
if [[ $1 == "" ]]
	then
	echo -e "1.Создать\n2.Редактировать\n3.Удалить\n4.Показать"
	read action
	case $action in
		1)
			create
			;;
		2)
			edit
			;;
		3)
			remove
			;;
		4)
			show
			;;
	esac
else
	track
fi
